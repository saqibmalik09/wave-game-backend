generator client {
  provider = "prisma-client-js"
  output   = "../generated/master"
}

datasource db {
  provider = "mysql"
  url      = env("MASTER_DATABASE_URL")
}

model Organization {
  id         Int      @id @default(autoincrement())
  name       String
  email      String   @unique
  dbHost     String
  dbName     String
  dbUser     String
  dbPassword String
  status     String   @default("active")
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  administrators Administrator[]
}

model Administrator {
  id             Int      @id @default(autoincrement())
  email          String   @unique
  password       String   @default("goldenSand")
  role           String   @default("superadmin")
  organizationId Int
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  organization Organization @relation(fields: [organizationId], references: [id])
}

model User {
  id        Int      @id @default(autoincrement())
  userId    String?
  name      String?
  appKey    String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([appKey])
}

model Game {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  appKey      String?
  token       String?
  status      String   @default("active")
  config      Json?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([appKey])
}

model Bet {
  id        Int      @id @default(autoincrement())
  gameId    Int
  userId    String? // must match User.id type
  bet       Int?
  type      Int?
  appKey    String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([gameId])
  @@index([userId])
}

model GameOngoingUsers {
  id        Int      @id @default(autoincrement())
  userId    String?
  appKey    String?
  socketId  String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([appKey])
}

model OngoingTeenpattiGame {
  id             Int      @id @default(autoincrement())
  userId         String?
  socketId       String?
  balance        Int?
  profilePicture String?
  potIndex       Int?
  appKey         String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}
